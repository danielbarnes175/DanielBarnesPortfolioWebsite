<!doctype html>
<html>
	<head>
		<title>Daniel Barnes</title>
		<link rel="stylesheet" href="https://unpkg.com/purecss@1.0.0/build/pure-min.css" integrity="sha384-nn4HPE8lTHyVtfCBi5yW9d20FjT8BJwUXyWZT9InLYax14RDjBj46LmSztkmNP9w" crossorigin="anonymous">
		<link href="../../main.css" rel="stylesheet" type="text/css" />
		<link href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">
	</head>
		<body>
			<header>
				<div class="pure-menu pure-u-1">
				<nav>
					<span class="pure-menu-heading"><h1>Daniel Barnes Portfolio</h1></span>
					<ul class="pure-menu-list">
						<li class="pure-menu-item pure-menu-custom"><a href="../blog.html" class="pure-menu-link">Back</a></li>
					</ul>
				</nav>
				</div>

			</header>

			<div class="pure-g">
				<div class="pure-u-1 pure-u-md-1-2 pure-u-s-1 pure-u-lg-1-4">
					<h1>Creating the Lottery</h1>
					<p class="p-blog-post">
						December 4, 2018

						<br><br>

						Man, it's hard doing this everyday. Right now it's 11:25pm and I was really tempted to skip this. I committed to my mission though, so I couldn't just let it go. So I guess lets crank this bad puppy boy out...

						<br><br>

						So the other day, and of course by the other day I mean yesterday, I had some free time so I spent it working on my Discord Bot. What? You didn't know about my Discord Bot? Oh... Yeah, you're right, I haven't finished the content for the projects section of the website... Oops! Well anyway, in case you didn't know, I've been creating a chat bot for Discord. Discord's a chat client to keep it simple.

						<br><br>

						So I wanted to add a feature where somebody could raffle something off in the server. Here was my plan:

						<br><br>

						I would have 3 commands: lotto, join, and draw.

						<br><br>

						Lotto would check if a lotto is started and if not, it would create a lotto. With all of these commands, I would need a way of storing information on the lotto. I would need the entrants, what's being raffled, and the person who started the lotto. Where would I keep this information? I would keep it in the only file that I know is easy to read information from -> a JSON file.

						<br><br>

						So I created a JSON file and gave it the following parameters:

						<br><br>

						<strong>hasStarted</strong> //A boolean value for if a lotto has been started.<br>
						<strong>item</strong> //A string that the lotto starter would enter in as what he or she is raffling.<br>
						<strong>lottoStarter</strong> //The person who started the ongoing lotto. This is needed so they don't enter their own lotto and you also know who is giving the item.<br>
						<strong>entrants</strong> //A list of entrants into the lotto.

						<br><br>

						So when a lotto is started, I update <strong>hasStarted</strong> to <strong>true</strong>. I also take the arguments from the command (basically everything after the command ~lotto when they send the message) and set that as the <strong>item</strong>. I also set the person for <strong>lottoStarter</strong>. After this is all done, I send a message to the server saying the lotto has started for x item.

						<br><br>

						Next we move onto the join phase. Anyone in the server (excluding the person who started the lotto) can join the lotto with ~join. When they do this, they get added to the list of entrants. If they have already joined the lotto, they can't join again of course because that would make the lotto unfair.

						<br><br>

						When the lotto starter so chooses, they can type in ~draw. When this happens, I generate a random number from 0-the amount of entrants - 1 (the list of entrants is an array). Then I find out which person that is and store it in a variable for later. After I have the winner, I clear the <strong>entrants</strong>, <strong>item</strong>, and <strong>lottoStarter</strong>. I also set <strong>hasStarted</strong> to <strong>false</strong>. Lastly, I send a message to the server saying who won.

						<br><br>

						From my testing, it looked like the feature worked as intended. I was proud of my work. Before I started, I only knew how to take information from a JSON file, not update it. It was actually a lot simpler than I thought! You have a variable for all the content of the file, and just like accessing a certain part of it you can just do variableforJSON.section, but this time set it to something. Of course, this doesn't change the file yet. To do that, you have to just copy the ENTIRE content back into the original file. I always kind of assumed you had to edit specific lines in the file, but it makes sense that you would rewrite the whole file.

						<br><br>

						Anyway, I had pushed my changes to GitHub, pulled them on the public bot, and decided to run a stress test lottery with the server my high school friends are in. It was at this moment that I realized that I had made a grave mistake. I had forgotten to differentiate servers! The way I had it setup was that if someone on one server starts a lotto, people can join on another one.

						<br><br>

						Of course, the fix for this is as simple as just adding another set in the JSON file that just stores the server, and then each server will have the variables that I listed earlier. I could also even remove the server from the file when a lotto isn't running, so then to see if a lotto is running, I just check if the server is on the list. This would definitely cut down on the filesize because I wouldn't have to store servers that aren't being used. I could also get rid of the <strong>hasStarted</strong> parameter because it would be obsolete at that point.

						<br><br>

						Either way, I still haven't fixed the bug yet. Despite that, it was still a fun experience because I feel like I actually knew what I was doing, and it wasn't just a silly command. It was something that could actually be useful, and I did it all on my own.

						<br><br>

						So that made my day a little better. It's almost 12:00 am (it's 11:55pm) so it looks like I'm going to have to end this one here. Going into the next day would basically be cheating!

						<br><br>

						Take care, friend.



					<br><br>

					</p>
				</div>
			</div>
		</body>
	<footer class="footer-long-pages"></footer>
</html>